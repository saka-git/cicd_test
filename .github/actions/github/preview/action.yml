name: "ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªãƒ³ã‚¯ã®ã‚³ãƒ¡ãƒ³ãƒˆ"
description: "ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã€GitHubã®PRã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã—ã¾ã™"

inputs:
  vercel_url:
    description: "ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã®URL"
    required: true
  app_name:
    description: "ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åå‰"
    required: true
  pr_number:
    description: "PRã®ç•ªå·"
    required: true
  commit_sha:
    description: "ã‚³ãƒŸãƒƒãƒˆã®SHA"
    required: true
  owner:
    description: "ãƒªãƒã‚¸ãƒˆãƒªã®ã‚ªãƒ¼ãƒŠãƒ¼"
    required: true
  repo:
    description: "ãƒªãƒã‚¸ãƒˆãƒªã®åå‰"
    required: true

runs:
  using: "composite"
  steps:
    - name: PRã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ¡ãƒ³ãƒˆ
      uses: actions/github-script@v6
      env:
        VERCEL_URL: ${{ inputs.vercel_url }}
        APP_NAME: ${{ inputs.app_name }}
      with:
        script: |
          const prNumber = "${{ inputs.pr_number }}";
          const commitSha = "${{ inputs.commit_sha }}";
          const appName = process.env.APP_NAME;
          const vercelUrl = process.env.VERCEL_URL;
          const owner = "${{ inputs.owner }}";
          const repo = "${{ inputs.repo }}";

          const commitUrl = `https://github.com/${owner}/${repo}/commit/${commitSha}`;

          const commentBody = `ğŸš€ **${appName}ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã—ãŸ**
          æœ€æ–°ã®å¤‰æ›´ãŒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã—ãŸã€‚

          ğŸ”— **Vercel ã®ãƒ‡ãƒ—ãƒ­ã‚¤ URL:** [${vercelUrl}](${vercelUrl})

          ğŸ”— **ã‚³ãƒŸãƒƒãƒˆ SHA:** [\`${commitSha}\`](${commitUrl})`;

          await github.rest.issues.createComment({
            owner: context.repo.owner,
            repo: context.repo.repo,
            issue_number: parseInt(prNumber),
            body: commentBody,
          });
